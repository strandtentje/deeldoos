{
	instances = {
		#include f"settings.conf"

		diritem = Template(f"templates/directory.html");

		fileitem = Template(f"templates/file.html");

		navigate = Template(f"templates/deeldoos.html") {
			browser->FilesystemBrowser(rootpath = instances.settings.rootpath) {
				diritem->instances.diritem;
				fileitem->instances.fileitem;
			};
		};

		dirfinder = LookupReader(lookupkeyname = "q", lookupname = "dirindex") {
			iterator->instances.diritem;
		};

		filefinder = LookupReader(lookupkeyname = "q", lookupname = "fileindex") {
			iterator->instances.fileitem;
		};

		findfile = GetFieldReader(field_q = ".{1,45}") {
			form->Template(f"templates/zoekpagina.html") {
				directories->instances.dirfinder;
				files->instances.filefinder;
			};
			successful->.form_branch;
		};

		content = SiteSubsection() {
			main->Template(f"templates/menu.html");
			navigate->instances.navigate;
			search->instances.findfile;
			about->Template(f"templates/about.html");
			network->Module(file = f"network.conf", branch = "network");
		};

		deeldoos = SiteSubsection() {
			default->Template(f"templates/skelet.html") {
				style->Module(file = f"style.conf", branch = "style");
				content->instances.content;
			};
			static->Fileserver(rootpath = f"static", optionalmimetypes = true, allowedmimetypes = {
				png = "image/png"; js = "text/javascript"; zip = "application/octet-stream"
			});
			getfile->Fileserver(rootpath = instances.settings.rootpath, optionalmimetypes = true, dot_png = "image/png");
			tar->Tarballer(rootpath = instances.settings.rootpath);
			window->Template(f"templates/window.html") {
				body->instances.content;
			};
		};

		filewalker = FilesystemIndexer(rootpath = instances.settings.rootpath) {
			newfile->LookupWriter(lookupkeyname = "keywords", lookupname = "fileindex", metaname = "fullname");
			newdirectory->LookupWriter(lookupkeyname = "keywords", lookupname = "dirindex", metaname = "fullname");
			deletedfile->LookupExterminator(lookupname = "fileindex", metaname = "fullname");
			deleteddirectory->LookupExterminator(lookupname = "dirindex", metaname = "fullname");
		};
	};
}
